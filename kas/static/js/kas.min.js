(function(){var addItem;window.App=angular.module("kas",["kas.controllers","typeahead"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/transactions",{templateUrl:window.prefix+"partials/kas/transactions.html",controller:"TransactionController"}),$routeProvider.when("/closures",{templateUrl:window.prefix+"partials/kas/closures.html",controller:"ClosureController"}),$routeProvider.when("/closures/:closureID",{templateUrl:window.prefix+"partials/kas/closure.html",controller:"ClosureDetailController"}),$routeProvider.otherwise({redirectTo:"/transactions"})}]),addItem={},angular.module("kas.controllers",["kas.apiv2"]).controller("TransactionController",["$scope","Transaction",function($scope,Transaction){return $scope.transactions=[],Transaction.all(function(transactions){return $scope.transactions=transactions}),addItem=function(transaction){return $scope.transactions.push(transaction)},$scope.next=function(){return $scope.transactions.next(function(items){return $scope.items=items})},$scope.previous=function(){return $scope.transactions.previous(function(items){return $scope.items=items})}}]).controller("TransactionFormController",["$scope","Transaction",function($scope,Transaction){return angular.element("input[ng-model='amount']").focus(),$scope.inout="OUT",$scope.toggleInout=function(){return $scope.inout="OUT"===$scope.inout?"IN":"OUT","OUT"===$scope.inout?$scope.method="CASH":void 0},$scope.method="CASH",$scope.toggleMethod=function(){return $scope.method="CASH"===$scope.method?"PIN":"CASH","PIN"===$scope.method?$scope.inout="IN":void 0},$scope.submit=function(){var transaction;return $scope.amount&&$scope.description?(transaction=new Transaction,transaction.amount=Math.abs(parseFloat($scope.amount.replace(",","."))),"OUT"===$scope.inout&&(transaction.amount*=-1),transaction.method="CASH"===$scope.method?"C":"P",transaction.description=$scope.description,transaction.valid=!0,console.log(transaction),transaction.create(function(obj){return $scope.inout="OUT",$scope.method="CASH",$scope.amount="",$scope.description="",addItem(obj),angular.element("input[ng-model='amount']").focus()})):void 0}}]).controller("ClosureController",["$scope","Transaction","Closure",function($scope,Transaction,Closure){return $scope.closures=[],Closure.all(function(closures){return $scope.closures=closures})}]),angular.module("kas.apiv2",["dienst2"]).factory("Transaction",["Tastypie",function(Tastypie){var Transaction;return Transaction=Tastypie("api/v2/transaction/"),Transaction.prototype.toString=function(){return this.description},Transaction.prototype.toggleValid=function(){return this.valid=this.valid?!1:!0,this.update()},Transaction}]).factory("Closure",["Tastypie",function(Tastypie){var Closure;return Closure=Tastypie("api/v2/closure/"),Closure.prototype.toString=function(){return this.date},Closure}])}).call(this);